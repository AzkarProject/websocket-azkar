<html>

<head>
</head>

<head>
    <meta charset="utf-8" />
    <meta name='keywords' content='WebRTC, HTML5, JavaScript' />
    <meta name='description' content='WebRTC benchmarks base for AZKAR project' />
    <meta name='viewport' content='width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1'>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/prettyPhoto.css" type="text/css" media="screen" title="prettyPhoto main stylesheet" charset="utf-8" />
    
    


    <!--
    Version incompatible avec le webcomposant d'Hugo & François !!!!
    <script src="/js/lib/jquery-1-11-4/external/jquery/jquery.js"></script>
    -->
	
	<script src='/js/lib/jquery-1.11.3.min.js'></script>
	
	
	<script src="/js/lib/jquery-1-11-4/jquery-ui.js"></script>
	<link href="/js/lib/jquery-1-11-4/jquery-ui.css" rel="stylesheet">
	

    <link rel="import" href="/web_kom-remote/kom-remote.html">

        <!-- Plugin lightbox -->
        <script src="/js/lib/jquery.prettyPhoto.js" type="text/javascript" charset="utf-8"></script>
        
        <style>
                
            #preview {padding: 3px;}
            #preview a:hover, a:visited, a:link, a:active {text-decoration: none;}
			.pp_inline { height:90%;}
			

			.cover {
				cursor:pointer;
                width:60px;
                height:60px;
                margin:3px;
				box-shadow: 0px 0px 150px #000000;
				border-radius: 5px;
				transition: all 200ms ease-in;
    			transform: scale(1); 
			}

			/* l'élément survolé */
			.cover:hover{
			    /*transform: rotateY(0deg) scale(1.2);*/
			    transition: all 100ms ease-in;
    			transform: scale(1.5);

			}

			.draggable {
				cursor: move;
			}

			.noDraggable {
				cursor: pointer;
			}

			#remoteCam:hover {
				/*z-index:99;*/
			}

			.blackOpacity {
				background:rgba(221,221,221,0.1);
			}

			.hidden
					
        </style>

		<script>
				
				// Rafraichissement du listener de la lightbox
				// pour les vignettes de recommandations chargées dynamiquement
				$(document).ready(function(){
				    pprefresh();
				});

				function pprefresh(){
				    $("a[rel^='prettyPhoto']").prettyPhoto();
				}

            // Prédéclaration d'une variable de fonction anonyme
            // Pour la précharger dans le dom du document et du webComposant d'Hugo et François
            // En attendant de la modifier par une vraie fonction a la fin du chargement de la page...
            myWTF = null;

		        
        </script>

    <title>1to1-Pilote</title>

</head>



<body class="ihmPilote" id="bodyPilot" style="background-color:#000000 ;">
    
    <!--
    <strong><span id="zone_info_server">WebRTC AZKAR</span></strong>
    <hr/>
    -->
        

    <section id="viewPortPilote" class="" style="" >

   
   			<div id="remoteCam" class='draggable resizable' 
   			style="position:absolute;top:0px; left:0px;float:left;width:1230px; height:375px;border:1px solid #ccc;border-radius: 10px;margin: 5px 5px 10px 5px">
			                		            		

				<video id='1to1_remoteVideo' 
					width="100%" height="100%" 
					style="background-color:black; margin: 0 auto;" 
					autoplay muted controls="controls">

				</video>
			</div>	

			
			<div id="localCam" class='draggable' 
			style="position:absolute;top:150px; left:100px;float:left;z-index:100;height:160px;width:160px; border:1px solid #ccc;border-radius: 10px;margin: 0">
		                						  	 	
			
				<video id='1to1_localVideo'
    				width="160" height="160"
    				style="background-color:black; margin: 0 auto;" 
    				autoplay muted controls="controls">
    		 	</video>
			</div>	

			<div id="map" class='draggable' 
			style="position:absolute;top:390px; left:0px;color:white;float:left; width:495px;height:230px;border:1px solid #ccc; border-radius: 10px;margin:0 0 0 5px;padding:5px;overflow:hidden;background:rgba(221,221,221,0.1);">	

				<div id="navButtons" style="text-align:center; float:left;">
                    
                    <button id="resetMap" class="groupCarto" onclick="resetMap()">Reset</button>
					&nbsp;&nbsp; 
                    <button id="zoomIn" class="groupCarto" onclick="zoomCarto('In')">Zoom +</button>
                    <button id="zoomOut" class="groupCarto" onclick="zoomCarto('Out')">Zoom -</button>
					&nbsp;&nbsp;
                    <button id="translateLeft" class="groupCarto" onclick="translationMap('Left')">Left</button>
                    <button id="translateUp" class="groupCarto" onclick="translationMap('Up')">Up</button>
                    <button id="translateDown" class="groupCarto" onclick="translationMap('Down')">Down</button>
                    <button id="translateRight" class="groupCarto" onclick="translationMap('Right')">Right</button>
					&nbsp;&nbsp;
                    <button id="trackingMode" class="groupCarto" onclick="trakingMode()">Tracking</button>
                 
                 	
                 	<!--<canvas id="myCanvas" width="520" height="200" style="border:1px solid #ccc; margin: 0 auto;background-color: black; border-radius: 10px;"></canvas>-->
                 	<canvas class="noDraggable" id="myCanvas" width="495" height="200"></canvas>
                </div>
			</div>

			<div id="drive" class='draggable' 
			style="position:absolute;top:390px; left:510px; color:white;float:left; z-index:100;width:230px;height:230px;background-color: black;border:1px solid #ccc; border-radius: 10px;margin:0 0 0 5px;padding:5px;overflow:hidden; background:rgba(221,221,221,0.1);">

				<div id="contentFloorCamera" class="noDraggable" style="width:228px;height:228px; margin: 0;">
			 	
				 	<video id='floor_localVideo' 
						width="200" height="200"
						style="background-color: black;background-image: url('images/floor200par150.jpg');background-repeat: no-repeat;background-position: center;margin:30px 0 0 14px;" 
						autoplay muted ">
				 	</video>

			 	</div>

				<div id = "overlayCommands"  style="float:left; margin: -230 0 0 0; position:relative">

					<div id="robotButtons" class="" style="height:230px; ">


				        <div id="step-commands" class="noDraggable">                   
				            
				            <kom-remote class="kom-remote"></kom-remote>

				        </div>

				  
						<div id="drive-commands" class="noDraggable" style="display:none; text-align:center;">    
				    
				            

				            <div id = "gamepadDefault"> 		                           
				                <div style="width:228px;height:228px;text-align:center">
				                    <img src="/images/logo/gamepad360.png" style="display:none; width:50px;height:35px;" alt="" />
				                </div> 
				            </div> 

				            <div id = "fullAxesInfos" ">
								<span id="fullDriveButtonStatus"></span>
				                
				                <div 
				                
				                style="	text-align:center;
										overflow: hidden;
										position: relative;
										width: 200px;
										height: 200px;
										background: rgba(221,221,221,0.1);
										margin: auto;
										border-radius: 50%;
										margin:0 0 0 15px;
										">
				                    
				                   <canvas id="canvasGamepad" width="200"; height="200"; style=""></canvas>
				                
				                </div>  
							</div>
						
						
						</div>

				    
				        <div id = "gamePadInfos" class="noDraggable" style="display:none; text-align:center;">
				         
				            <span id="buttonStatus"></span>

							<div 
				                
				                style="	text-align:center;
										overflow: hidden;
										position: relative;
										width: 200px;
										height: 200px;
										background: rgba(221,221,221,0.1);
										margin: auto;
										border-radius: 50%;
										margin:0 0 0 15px;
										">
				                    
				                 <div id="classicDrive" style="margin-top:20px"> 
					                <b>Direction</b><br/>
						            <progress id="leftRight" value=1 max=2></progress><br><br/>

						            <b>Speed</b><br/>
						             Avance:<br/><progress  id="advanceValue" value=0 min=0 max=1></progress>
						             <br/>
						             Reverse:<br/><progress id="reverseValue" value=0 min=0 max=1></progress>
					             </div>
				            


				            </div>  

				        </div>

				        <div id = "cameraInfos" class="noDraggable" style="display:none; text-align:center;"> 


				            <span id="buttonStatusDivCam"></span>
				            			            
				            <div style="text-align:center;
										overflow: hidden;
										position: relative;
										width: 200px;
										height: 200px;
										background: rgba(221,221,221,0.1);
										margin: auto;
										border-radius: 50%;
										margin:0 0 0 15px;
										">
				                <img src="/images/logo/webcam.png" style="width:200px;height:200px;margin:0" alt="" />
				            </div> 
				        </div> 


					</div>

				</div>           
			</div>                   


			<div id="nav" class='draggable' 
			style="position:absolute;top:390px; left:755px; float:left; width:335px;height:230px;background-color: black;border:1px solid #ccc; border-radius: 10px;margin:0 0 0 5px;padding:5px; background:rgba(221,221,221,0.1);">

				

			    
			    <div style="width:100%;text-align:center">
			    	<span id="pointOfinterestTitle" style="color:white;"> Navigation</span>
			    </div>
			    
			   	<br/>
				
				

				<div style="width:100%;text-align:center;margin: 0 0 5px 0">
			    	<button id="goto_POI" style='height:50px' onclick="gotoPOI()">GO</button>
			    	<button id="stop_Trajectory" class="txtRed" style='height:50px' onclick="stopTrajectory()">STOP TRAJECTORY</button>
			    	<button id="relocalize" class="" style='height:50px' onclick="relocalize()">Relocalize</button>
			    </div>

				<div style="width:100%;text-align:center" class='noDraggable'>
			        <div class="select">
			            
			            <select id="list_POI">
			            </select>
			            
			        </div>
			    </div>  

			    <div style="width:100%;text-align:center;color:white;">
			    	<h5>
			    		<span id="robotStatusMessage"><span>
			    	</h5>
			    </div>
			   
			</div>


			<div id="connexion" class='draggable' 
			style="position:absolute ;top:390px; left:1110px; float:left; z-index:125; width:110px;height:230px;background-color: black;color:white;border:1px solid #ccc; border-radius: 10px;margin:0 0 0 5px;padding:5px; background:rgba(221,221,221,0.1);">

				<div style="text-align:center">Résolutions</div>

					<br/>				
						
						
						<div id="cnxButtons" style="background:rgba(221,221,221,0.1); text-align:center; float:left;margin: 0 auto ">
			        

							<button class="shadowBlack groupDefCam" style=""  id="144p" onclick="openDef('144p')">
								Très basse
							</button>

							<br/>
							
							<button class="shadowBlack groupDefCam" style="" id="QVGA" onclick="openDef('QVGA')">
			                   Basse
			                </button>

			                <br/>

			                <button class="shadowBlack groupDefCam" style="" id="VGA" onclick="openDef('VGA')">
			                    Moyenne
			                </button>

			                <br/>

			                <button class="shadowBlack groupDefCam" style="" id="SVGA" onclick="openDef('SVGA')">
			                    Haute
			                </button>

			                <br/>

			                <button class="shadowBlack groupDefCam" style="" id="HD" onclick="openDef('HD')">
			                    Très haute
			                </button>


			          		<span id="closeConnection"></span>	

			          </div>

				
				<!-- Non affichés mais conservés pour garder une rétrocompatibilité avec l'algo général et ne pas devoir tout réecrire -->
				<!-- Todo: les afficher dans un overlay ou dans une popup... -->
			</div>


			<div id="settings"  class='draggable'
			style="position:absolute;top:50px; left:300px;display:none;float:left; width:770px;border:1px solid #ccc; border-radius: 10px;margin:10px 5px 5px 5px;padding:5px; background:rgba(221,221,221,0.6);z-index:999998">


				<div class="conrolAdvancedSettingsDiv">
					
					<div id="settingsButtons" style="text-align:center; float:right ;margin: 0 auto ">
		        		<button class="shadowBlack" style=""  id="closeSettings" onclick="switchDisplay('settings','close')">
							close
						</button>
					</div>

				</div>
				<hr/>

				<div id="camerasAdvancedSettings" style="float:left;width:370px">
					
					<div id="robotCameras"
	                	class="devicef"
						style="color:white;float:left; width:350px;background-color:red;border:1px solid #ccc; border-radius: 10px;margin:5px;padding:5px;overflow:hidden;">
		                <strong>Robot Devices</strong>
		                <hr/>
		                <div class="select noDraggable">
		                    <label for="remote_videoSource" style='width:150px;background-color:black' >Video: </label>
		                    <select id="remote_videoSource" style='width:200px;'></select>
		                </div>
		                <div class="select noDraggable"">
		                    <label for="remote_audioSource" style='width:150px;background-color:black' >Audio: </label>
		                    <select id="remote_audioSource" style='width:200px;'></select>
		                </div>
		                <hr/>
						<button id="remote_ButtonDevices" onclick="remoteManageDevices()">Sélectionner</button>
					</div>
					
					<div id="pilotCameras"
						class="devicef"
						style="color:white;float:left; width:350px;background-color:red;border:1px solid #ccc; border-radius: 10px;margin:5px;padding:5px;overflow:hidden;">
		                <strong> Pilote Devices</strong>
						<hr/>
		                <div class="select noDraggable">
		                    <label for="local_videoSource" style='width:150px;background-color:black' >Video: </label>
		                    <select id="local_videoSource"style='width:200px;'></select>
		                </div>
		                <div class="select noDraggable">
		                    <label for="local_audioSource" enabled='true' style='width:150px;background-color:black' >Audio: </label>
		                    <select id="local_audioSource"style='width:200px;'></select>
		                </div>

	                </div>
                </div>	



				<div id="advancedSettings " 
				style="color:white;float:left; width:350px;background-color:red;border:1px solid #ccc; border-radius: 10px;margin:5px;padding:5px;overflow:hidden;">

					<div id="robotVideoSetting" class="appParameters noDraggable">
		               	Robot:
		                <label for="robot_camdef_select">Camera Resolution &nbsp;&nbsp; </label>
		                <select id="robot_camdef_select"></select>
						<hr/>
						IHM Robot - Local view:
		                <input type="radio" name="RlVidSetting" value="show" id="RlVshow" checked onclick="setRobotLocalView('show')"> <label for="RlVshow">Show</label>
		                <input type="radio" name="RlVidSetting" value="hide" id="RlVhide" onclick="setRobotLocalView('hide')"/> <label for="RlVhide">Hide</label>
		                <hr/> 
		                IHM Robot - Remote view:
		                <input type="radio" name="RRVidSetting" value="show" id="RRVshow" checked onclick="setRobotRemoteView('show')"> <label for="RRVshow">Show</label>
		                <input type="radio" name="RRVidSetting" value="hide" id="RRVhide" onclick="setRobotRemoteView('hide')"/> <label for="RRVhide">Hide</label>

		            </div>
		          	
		          	<hr/>
		            
		            <div id="piloteVideoSetting" class="appParameters">
		                Pilote: 
						<label for="pilot_camdef_select">Camera Resolution &nbsp;&nbsp; </label>
		                <select id="pilot_camdef_select"></select>
						<hr/>
		                IHM Pilote - Local view: 
		                <input type="radio" name="PlVidSetting" value="show" id="PlVshow" checked onclick="setPiloteLocalView('show')"> <label for="PlVshow">Show</label>
		                <input type="radio" name="PlVidSetting" value="hide" id="PlVhide" onclick="setPiloteLocalView('hide')"/> <label for="PlVhide">Hide</label>
		                <hr/>
		                IHM Pilote - Remote view: 
		                <input type="radio" name="PRVidSetting" value="high" id="PRVhigh" onclick="setPiloteRemoteView('show')" checked/> <label for="PRVhigh">Show</label>
		                <input type="radio" name="PRVidSetting" value="hide" id="PRVhide" onclick="setPiloteRemoteView('hide')"/> <label for="PRVhide">Hide</label>
		            </div>
		        
		        </div>
		        

				               


				<!-- pour compatibilité avec l'ancienne version -->
				<div id="robotDevices" style="display:none"></div>
				<div id="pilotDevices" style="display:none"></div>







				<div id="dataChannelSetting"
					class='draggable' 
					style="color:white;float:left; width:350px;background-color:red;border:1px solid #ccc; border-radius: 10px;margin:5px;padding:5px;overflow:hidden;">

					Channel:
	                <input type="radio" name="controlChannel" value="webSocket" id="webSocket" onclick="setNavChannel('webSocket')" checked /> <label for="webSocket">webSocket</label>
	                <input type="radio" name="controlChannel" value="webRTC" id="webRTC" onclick="setNavChannel('webRTC')"/> <label for="webRTC">webRTC</label>
	            </div>


	            <div id="1to1_master_connection" class="device" style="display:none">
	                
	                <span id="openConnection">
	                    <button class="shadowBlack" id="local_ButtonDevices" onclick="localManageDevices()">
	                        Ouvrir la connexion
	                    </button>
	                </span>
	            </div>    
   
					

			</div>



			<div id = 'tchat' class='draggable' 
			style="position:absolute;top:50px; left:300px;display:none;float:left; width:770px;border:1px solid #ccc; border-radius: 10px;margin:10px 5px 5px 5px;padding:5px;background-color:grey; z-index:999997">

			        <div id="websocketChat"  style="height:200px">
	                    <strong> Websocket Messages & Chat</strong>
	                    <hr/>
	                    <form action="/" method="post" id="formulaire_chat_websoket">
	                        <input type="text" name="message" id="message" placeholder="Votre message..." size="28" autofocus />
	                        <button id="envoi_message" type="submit">Envoyer</button>
	                    </form>
	                    <hr class="hrForm">
	                    <textarea class="input" id="zone_chat_websocket" readonly="readonly" placeholder="Once upon a time..." size="20" style="height:100px"></textarea>
	                    <form id="text-options1">
	                        <label><input type="text1" class="filename" id="text-filename1" placeholder="Pilote_WS_LOGS" />.txt</label>
	                        <button id="saveLogs_webSocket" type="submit" value="Save" />Save</button>
	                    </form>
	                </div>
				

			        <div id="dataChannelArea">
	                        <strong> WebRTC dataChannel Log </strong>
	                        <hr/>
	                        <div id="formulaire_chat_webRTC" class="pseudoForm">
	                            <input type="text" name="message" id="input_chat_WebRTC" disabled placeholder="Waiting open channel..." size="28" autofocus />
	                            <button id="env_msg_WebRTC" disabled onclick="sendMessage()">Envoyer</button>
	                        </div>
	                        <hr class="hrForm">
	                        <textarea class="input" id="zone_chat_WebRTC" readonly="readonly" placeholder="Once upon a time..." size="20" style="height:100px"></textarea>
	                        <form id="text-options2">
	                            <label><input type="text" class="filename" id="text-filename2" placeholder="Pilote_WebRTC_LOGS" />.txt</label>
	                            <button id="saveLogs_webRTC" type="submit" value="Save" />Save</button>
	                        </form>
	                </div>
			</div>


			<div id="iHmControls" class="draggable"
			style="position:absolute;top:340px;width:800px;left:300px;float:left;border:1px solid #ccc; border-radius: 10px;margin:10px 5px 5px 5px;padding:5px; background:blue;z-index:999999">
				
				<div id="batteryJauge" style="float:left; text-align:center;color:white;">
	                <label for="battery_level">Battery Level:</label>
	                <progress id="battery_level" max="100" style="width:100px"></progress>
	            </div>

				<div id="AdvancedMenu" style="color:white; text-align:center; float:left ;margin: 0 auto ">
			     	&nbsp;&nbsp;

			     	Modules:

					<button class="shadowBlack" style=""  id="switchsettings" onclick="switchDisplay('settings','open')">
						Settings
					</button>

					<button class="shadowBlack" style=""  id="switchmap" onclick="switchDisplay('map','close')">
						Map
					</button>

					<button class="shadowBlack" style=""  id="switchdrive" onclick="switchDisplay('drive','close')">
						Drive
					</button>

					<button class="shadowBlack" style=""  id="switchnav" onclick="switchDisplay('nav','close')">
						Nav
					</button>

					<button class="shadowBlack" style=""  id="switchconnexion" onclick="switchDisplay('connexion','close')">
						Connexion
					</button>

					<button class="shadowBlack" style=""  id="switchtchat" onclick="switchDisplay('tchat','close')">
						Tchat
					</button>

			    	<button class="shadowBlack" style=""  id="resetIhm" onclick="switchDisplay(null,'reset')">
						Reset
					</button>


			    </div>




			</div>

		<!--</div>-->


   </section>    


    <section id="TopNotification">
               
        <div id='recommandationMessage' class="miscelleanous recommandations" >
        </div>

        <div id='infoMessage' class="info message">
        </div>

        <div id='errorMessage' class="error message">
        </div>

        <div id='warningMessage' class="warning message">
        </div>

        <div id='sucessMessage' class="success message">
        </div>

        <div id='standardMessage' class="standard message">
        </div>
   
   </section>


    <section id="HudFullScreen">
     
            <div id="HUD_left"></div>
           
            <div id="HUD_right"></div>
	</section>

    
    <script>
        var type = "pilote-appelant";
        var proto = "1to1";
        var ihmVersion = "V2";
        // On initialise les flages du mode simulateur
        var fakeRobubox = null;

    </script>
    

    <script src="/socket.io/socket.io.js"></script>
    <script src='/js/lib/adapter.js'></script>
    <script src="/js/lib/FileSaver.js"></script>
    <script src="/js/lib/autobahn.min.jgz"></script>
    
    <script src="/js/common_tools.js"></script>
    <script src="/js/common_models.js"></script>
    <script src="/js/common_app_settings.js"></script>
    

    <script src='/js/1to1_01_websocket.js'></script>
    <script src='/js/1to1_02_pre_signaling.js'></script>
    <script src='/js/1to1_03_signaling.js'></script>
    <script src='/js/1to1_04_post_signaling.js'></script>

    <script src='/js/module_userconnection.js'></script>
    <script src='/js/module_navigation_interface.js'></script>
    <script src='/js/module_ihm.js'></script>
    <script src='/js/module_notifications.js'></script>
    <script src='/js/module_fake_robubox.js'></script>
    <script src='/js/module_carto.js'></script>
    <script src='/js/module_navigation.js'></script>
    <script src='/js/module_komremote.js'></script>
    <script src='/js/module_forms.js'></script>
    <script src='/js/module_foscam.js'></script>
    <script src='/js/module_gamepad.js'></script>
    <script src="/js/module_logs.js"></script>  
 

   

     <script type="text/javascript" charset="utf-8">
            
            
        $(document).ready(function(){
            
            $("area[rel^='prettyPhoto']").prettyPhoto();
            
            $(".gallery:first a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'normal',theme:'light_square',slideshow:3000, autoplay_slideshow: true});
            $(".gallery:gt(0) a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'fast',slideshow:10000, hideflash: true});
		    $( ".draggable" ).draggable({ cursor: "move", cancel: ".noDraggable" });
		    $( ".resizable" ).resizable();


        });


        /*
        video1.addEventListener("playing", function () {
		    console.log ("LocalStream dimensions: " + video1.videoWidth + "x" + video1.videoHeight)
		});

		video2.addEventListener("playing", function () {
		    console.log ("RemoteStream dimensions: " + video2.videoWidth + "x" + video2.videoHeight)
		});
		/**/

            
    </script>




    <script>                    
            // Affichage de l'entête
            ihm.getHeaderPage(pseudo);

            // Maintenant que le reste des scripts est chargé,
            // on affecte a la variable anonyme pré-chargée une vraie fonction
            // Ici, on fait passer les commandes de la caméra FOSCAM via le
            // WebComposant d'Hugo et François
            myWTF = function WTF_WebComposantDeHugoEtFrancois (commande) {
                    foscam.WTF(commande)
            }


            
    

    </script> 




</body>

</html>
